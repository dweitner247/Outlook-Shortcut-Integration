<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Shortcut Add-in</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

  <script>
    Office.onReady(() => {
      console.log("Office ist bereit – Add-in geladen (Testversion).");
    });

    async function createShortcutStory(event) {
      console.log("createShortcutStory (Test) gestartet");

      try {
        const item = Office.context.mailbox.item;

        // Betreff und Body der aktuellen Mail (nur Test)
        const subject = item.subject || "(Ohne Betreff)";
        const body = await getBodyAsync(item);

        console.log("Betreff:", subject);
        console.log("Body (Auszug):", body ? body.substring(0, 200) : "(kein Inhalt)");

        // Testmeldung in Outlook anzeigen
        Office.context.mailbox.item.notificationMessages.replaceAsync("testStatus", {
          type: "informationalMessage",
          message: "Test erfolgreich: Der Button wurde ausgelöst.",
          icon: "icon16",
          persistent: false
        });

      } catch (error) {
        console.error("Fehler im Test:", error);
        Office.context.mailbox.item.notificationMessages.replaceAsync("status", {
          type: "errorMessage",
          message: "Fehler im Test: " + error.message,
          persistent: false
        });
      } finally {
        // Für Command-Add-ins notwendig
        event.completed();
      }
    }

    // Body auslesen
    function getBodyAsync(item) {
      return new Promise((resolve, reject) => {
        item.body.getAsync("text", result => {
          if (result.status === Office.AsyncResultStatus.Succeeded) {
            resolve(result.value);
          } else {
            reject(result.error);
          }
        });
      });
    }

    // Funktion registrieren
    window.createShortcutStory = createShortcutStory;
  </script>
</head>

<body>
  <h1>Shortcut Integration – Test</h1>
</body>
</html>













